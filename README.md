# 卫星坐标解算
本软件使用用户下载的广播星历对文件内卫星的坐标进行计算，使用精密星历进行验证，并使用三维视图进行可视化。  
**本人使用Qt Creator 14.0.2 (Community)版本完成所有代码编写、程序运行工作，程序使用Enigma Virtual Box封装，教程可自行上网检索。**

## 数据导入
1. 点击`选择文件`按钮载入广播星历文件，也可直接输入文件地址。
2. 精密星历文件不是必要的，如果需要验证卫星坐标计算的精度可以载入。

## 卫星坐标解算
1. 日期（必填）：必须按照`YYYYMMDD`的格式输入
2. 时间（选填）：若填写时间，则必须按照`HHMMSS`的格式输入
3. PRN（选填）：若填写PRN，则必须填写卫星的<u>两位数</u>编号
4. 导航系统（必填）：必须选择<u>GPS或BDS</u>系统进行卫星坐标计算

上述必填项目填写完整后，点击`计算`按钮即可展示计算结果，计算结果格式如下：
| PRN/时刻 | 坐标维度 | 广播星历计算结果 | 精密星历计算结果 | 差值(m) |
| --------- | ----- | ------------ | ------------ | ------ |
| G02       | X     | 18023357.407 | 18023357.645 | -0.238 |
| 08:00:00  | Y     | 5606946.544  | 5606944.428  | 2.116  |
|           | Z     | 19287254.681 | 19287256.645 | -1.964 |

每个卫星坐标数据占三行，第一列分别是卫星的PRN和该数据所属时刻，后面数据精度均为毫米级，其中差值是广播星历与精密星历的计算结果之差。  

### 功能建议：
- 查询某一卫星系统某天内所有卫星覆盖的范围：不输入时间和PRN
- 查询某一时刻的所有卫星坐标：只输入时间，不输入PRN
- 查询某一卫星在当天内不同时刻的坐标：只输入PRN，不输入时间
- 查询某一卫星在某一时刻的坐标：既输入时间，又输入PRN

*p.s.* 本软件可以借助广播星历计算任意时间的卫星坐标，但无法使用精密星历进行验证。这是因为广播星历计算任意时刻卫星坐标的算法运行正常，
但对精密星历进行插值法计算的代码在debug时，Qt Creator 14.0.2 (Community)一直出现`No executable specified.`的提示。这一问题在作业提交后仍未得到解决。
因此当输入的任意时间在精密星历内能检索到时，可以直接调用精密星历内的卫星坐标进行验证，但检索不到时则无法验证，因为插值法部分代码的debug受阻。  
*2025.1.31更新*：目前对20240909的精密星历可以使用插值法，但对其余日期的似乎仍有bug

### 提示窗口：
- 读入广播星历：会提示广播星历内的数据量，以及GPS和BDS两个系统各自的数据量
- 读入精密星历：若精密星历文件名格式为默认格式，则会自动判断该精密星历文件所属的年积日是否与广播星历一致，若不一致则会提醒`精密星历的年积日与广播星历不一致`。如果文件名格式不是默认格式则无法判别。
- 计算卫星坐标：若输入的日期与广播星历内的日期不一致则会提醒，并借助广播星历文件名内的年积日反推正确的输入日期。
- 其他报错暂未提供提示，或提示被覆盖。

## 数据下载网站
点击按钮前往对应的网站下载广播星历和精密星历文件  
- 武大GIS网站：http://www.igs.gnsswhu.cn/index.php  
- NASA卫星数据网站：https://cddis.nasa.gov/archive/gnss/data/daily/2024/brdc/

其中后者在登录后是进入2024年广播星历的下载界面
<!--本人太蠢了不会做自动下载的功能，但是舍友做出来了感觉很厉害。
软件内输入CDDIS账号密码后在日历内选择日期，即可下载对应年积日的卫星星历文件-->

## 三维视图
在左侧卫星坐标解算成功后，点击`生成视图`按钮，则会出现左侧所有卫星坐标点的三维点云。  
中间的白色球体是地球，使用鼠标拖动或滑动滚轮即可改变视角，视图内左上角有颜色图例。  
<!--因为技术力低所以不会做地球贴图和宇宙背景贴图，大概看个示意就好了-->  
三维视图内的坐标系为**地心地固坐标系**：
- 以*地球质心*为原点  
- *x轴* 指向本初子午线与赤道的交点  
- *z轴* 与地轴平行指向北极点  
- *y轴* 垂直于xOz平面构成右手坐标系（即指向东经90度与赤道的交点）
- 三维视图中字母所处位置为各坐标轴的正方向

*p.s.* 三维视图的相对距离（指地球半径与卫星高度之比）是符合实际的
